/*!
 * CT-BOX JavaScript
 * v1.0.8.4 CT-BOX 版
 * http://www.ct-box.net/
 * Copyright 2011, CT-BOX service
 * Date: 2011-09-06
 * 更改:
 * 修正無$(document).ready()判斷時, jQuery未載入完成會有錯誤的問題
 */
Array.prototype.unique=function(){var c=[];var b=this.length;for(var e=0;e<b;e++){for(var d=e+1;d<b;d++){if(this[e]===this[d]){d=++e}}c.push(this[e])}return c};function ctb(){}ctb.url=window.location.href.replace(/[?&#]/g,"+++");ctb.strlen=800;ctb.titleStr;ctb.contentStr;ctb.ctbContent;ctb.ctbTagContent;ctb.blogName;var spaceReg=/^[\s　]+|[\s　]+|&nbsp;/gi;var tagReg=/<[^>]*>/gi;var andReg=/&|]]>|<|>/gi;ctb.tag={0:"ct0",1:"ct1",2:"ct2",3:"ct3",4:"ct4",5:"ct5"};ctb.jQueryStyle={yam:{title:".post_titlediv",content:".post_body .post_content"},pixnet:{title:".article-head .title",content:".article-body .article-content"},xuite:{title:".title .titlename",content:".blogbody #content_all"},blogspot:{title:".post-title",content:".post-body"},roodo:{title:".title",content:".main"},sina:{title:"h3.title",content:".blogbody"},udn:{title:".main-topic",content:".main-text"},imtv:{title:".PostTitle",content:".postshortcontent"},liontravel:{title:".post h3",content:".post-content"}};ctb.cssStyle={yam:{title:".post_titlediv",content:".post_content"},pixnet:{title:".title",content:".article-content"},xuite:{title:"span.titlename",content:"#content_all"},blogspot:{title:"h3.post-title,h3.post-title a",content:".post-body"},roodo:{title:"h3.title",content:".main"},sina:{title:"h3.title",content:".blogbody"},udn:{title:".main-topic",content:".main-text"},imtv:{title:".PostTitle",content:".postshortcontent"},liontravel:{title:".post h3",content:".post-content"}};ctb.getBlogText=function(){ctb.titleStr=jQuery(ctb.jQueryStyle[ctb.blogName]["title"]).text();ctb.contentStr=jQuery(ctb.jQueryStyle[ctb.blogName]["content"]).text();if(ctb.blogName=="xuite"){ctb.contentStr+=jQuery("div:regex(id,mainSubContent_.*)").text()}ctb.titleStr=ctb.titleStr.replace(spaceReg,"").replace(tagReg,"").replace(andReg,"").split("").unique().join("");ctb.contentStr=ctb.contentStr.replace(spaceReg,"").replace(tagReg,"").replace(andReg,"").split("").unique().join("")};ctb.isBlog=function(a){if(a.match(/(blog\.yam\.com).*/)){ctb.blogName="yam"}else{if(a.match(/pixnet\.net.*/)){ctb.blogName="pixnet"}else{if(a.match(/blog\.xuite\.net.*/)){ctb.blogName="xuite"}else{if(a.match(/blogspot\.com.*/)){ctb.blogName="blogspot"}else{if(a.match(/blog\.roodo\.com.*/)){ctb.blogName="roodo"}else{if(a.match(/blog\.sina\.com\.tw.*/)){ctb.blogName="sina"}else{if(a.match(/blog\.udn\.com.*/)){ctb.blogName="udn"}else{if(a.match(/www\.im\.tv.*/)){ctb.blogName="imtv"}else{if(a.match(/blog\.liontravel\.com.*/)){ctb.blogName="liontravel"}else{return false}}}}}}}}}return true};ctb.getCTBText=function(){ctb.ctbTagContent="<data>";var a=0;var b;for(_obj in ctb.tag){ctb.ctbTagContent+="<data_"+ctb.tag[a]+">";ctbnumID="#"+ctb.tag[a];ctbnumClass="."+ctb.tag[a];var c="";jQuery(ctbnumID).each(function(d){c+=this.innerHTML.replace(spaceReg,"").replace(tagReg,"").replace(andReg,"")});jQuery(ctbnumClass).each(function(d){c+=this.innerHTML.replace(spaceReg,"").replace(tagReg,"").replace(andReg,"")});if(c&&c.length<=ctb.strlen){ctb.ctbTagContent+=encodeURIComponent(c.split("").unique().join(""));ctb.strlen-=c.length;b=true}ctb.ctbTagContent+="</data_"+ctb.tag[a]+">";a++}ctb.ctbTagContent+="</data>";if(b){return true}else{return false}};ctb.sendNormal=function(){if(ctb.ctbContent!=""){var a="?callback=?&key=49bca877T7ZnkIptYjKL5oP-dHsMvHUhG5tr0Ta8VekUD78DoRL_OmkHMi4Umq1f8I7dAJoYEgwH6Y9AUO-fkbAnXY2RY0EWfmk2hcqoN216h2WADvV9adgV66S1ddIojn6SAeFScLQZZVlEtCu7gP8E3G8kkUd0Z-R3gKCUF180H9cg4M0=&url="+ctb.url+"&xml="+ctb.ctbTagContent;$.getJSON("http://dhs.ct-box.net/data/recept"+a)}};getDataNormal=function(a){jQuery.each(a,function(b,c){if(b=="font"){jQuery.each(this,function(e,d){jQuery("head").append("<style type='text/css'> @font-face { font-family: \""+e+'"; src: url('+d+'?type=eot); src: local(" "),      url('+d+'?type=ttf) format("truetype"),      url('+d+'?type=woff) format("woff");} #'+e+' { font-family: "'+e+'", Georgia, serif; }.'+e+' { font-family: "'+e+'", Georgia, serif; }</style>')})}if(b=="picture"){}})};ctb.main=function(a){jQuery.expr[":"].regex=function(h,e,d){var i=d[3].split(","),c=/^(data|css):/,b={method:i[0].match(c)?i[0].split(":")[0]:"attr",property:i.shift().replace(c,"")},g="ig",f=new RegExp(i.join("").replace(/^\s+|\s+$/g,""),g);return f.test(jQuery(h)[b.method](b.property))};if(ctb.isBlog(ctb.url)){ctb.getBlogText();ctb.genBlogXML();ctb.sendSmarty();if(ctb.getCTBText()){ctb.sendNormal()}}else{if(ctb.getCTBText()){ctb.sendNormal()}}};ctb.genBlogXML=function(){if(ctb.titleStr||ctb.contentStr){ctb.ctbContent="<data>";if(ctb.titleStr.length<=ctb.strlen){ctb.ctbContent+="<data_title>"+encodeURIComponent(ctb.titleStr)+"</data_title>";ctb.strlen-=ctb.titleStr.length}if(ctb.contentStr.length<=ctb.strlen){ctb.ctbContent+="<data_content>"+encodeURIComponent(ctb.contentStr)+"</data_content>";ctb.strlen-=ctb.contentStr.length}ctb.ctbContent+="</data>"}};ctb.sendSmarty=function(){if(ctb.ctbContent){var a="?callback=?&key=49bca877T7ZnkIptYjKL5oP-dHsMvHUhG5tr0Ta8VekUD78DoRL_OmkHMi4Umq1f8I7dAJoYEgwH6Y9AUO-fkbAnXY2RY0EWfmk2hcqoN216h2WADvV9adgV66S1ddIojn6SAeFScLQZZVlEtCu7gP8E3G8kkUd0Z-R3gKCUF180H9cg4M0=&url="+ctb.url+"&xml="+ctb.ctbContent;$.getJSON("http://dhs.ct-box.net/smarty/recept"+a)}};function getData(a){jQuery.each(a,function(c,d){var b="";if(c=="font"){jQuery.each(this,function(f,e){if(f=="title"){b=ctb.cssStyle[ctb.blogName]["title"]}if(f=="content"){b=ctb.cssStyle[ctb.blogName]["content"]}if(f=="content"&&ctb.blogName=="xuite"){jQuery("div:regex(id,mainSubContent_.*)").each(function(){b+=",#"+jQuery(this).attr("id")})}jQuery("head").append("<style type='text/css'> @font-face { font-family: \""+f+'"; src: url('+e+'?type=eot); src: local(" "),      url('+e+'?type=ttf) format("truetype"),      url('+e+'?type=woff) format("woff");} '+b+' { font-family: "'+f+'", Georgia, serif; }</style>')})}})}if(typeof $!="function"||typeof $().jquery!="string"){_unique_doc=document.getElementsByTagName("head")[0];_unique_js=document.createElement("script");_unique_js.setAttribute("type","text/javascript");_unique_js.setAttribute("src","http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js");_unique_doc.appendChild(_unique_js)}_unique_try2go=function(){if(typeof $=="function"&&typeof $().jquery=="string"&&$(document).ready){clearInterval(_unique_mainIntv);ctb.main()}};var _unique_mainIntv=setInterval(_unique_try2go,300);
